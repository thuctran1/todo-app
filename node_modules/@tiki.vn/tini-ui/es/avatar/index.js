import { getColorName, getShortname, getFontSize } from './utils';
var DefaultSize = 40;
Component({
  data: {
    shortName: null,
    color: null,
    fontSize: null,
    defaultSize: DefaultSize,
    defaultSrc: null
  },
  props: {
    shape: 'circle',
    showBorder: true,
    className: '',
    size: DefaultSize,
    src: null,
    name: '',
    lazyLoad: false,
    style: ''
  },
  deriveDataFromProps: function deriveDataFromProps(nextProps) {
    if (!nextProps.src) {
      this._setAvatarName(nextProps);
    }
  },
  methods: {
    _onError: function _onError(e) {
      var onError = this.props.onError;

      if (onError) {
        onError(e);
      }

      this._setAvatarName(this.props);
    },
    _onLoad: function _onLoad() {},
    _setAvatarName: function _setAvatarName(nextProps) {
      if (!nextProps.name) {
        this.setData({
          defaultSrc: 'https://salt.tikicdn.com/ts/miniapp/0f/7f/84/5af725e8a6a55815a24e8e6935ef99e3.png'
        });
        return;
      }

      var shortName = getShortname(nextProps.name);
      var color = getColorName(nextProps.name);
      var fontSize = getFontSize(+nextProps.size);
      var newData = {};

      if (shortName !== this.data.shortName) {
        newData.shortName = shortName;
      }

      if (color !== this.data.color) {
        newData.color = color;
      }

      if (fontSize !== this.data.fontSize) {
        newData.fontSize = fontSize;
      }

      if (Object.keys(newData)) {
        this.setData(newData);
      }
    }
  }
});